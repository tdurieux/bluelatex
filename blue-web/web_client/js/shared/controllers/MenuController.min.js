angular.module('bluelatex.Shared.Controllers.Menu',['bluelatex.Shared.Directives.Gravatar']).controller('MenuController',['$rootScope','$scope','$route',function(d,e,f){d.$watch('loggedUser',function(a){if(a.name==null){e.openUserMenu=false}e.user=a});e.$on("$routeChangeSuccess",function(a,b){e.menus=[];if(b.$$route==null)return;for(var i=0;i<g.length;i++){g[i].active=b.$$route.options.name==g[i].name;e.menus.push(g[i])}e.options=[];var c=h[b.$$route.options.name];if(c!=null)for(var i=0;i<c.length;i++){e.options.push(c[i])}});e.openUserMenu=false;var g=[{label:'New Paper',link:'#/paper/new',name:'new_paper',connected:true,unconnected:false,active:false},{label:'Papers',link:'#/papers',name:'papers',connected:true,unconnected:false,active:false},{label:'Login',link:'#/login',name:'login',connected:false,unconnected:true,active:false},{label:'Register',link:'#/register',name:'register',connected:false,unconnected:true,active:false}];var h={'papers':[],'paper':[{label:'Compile',type:'action',action:'compile',class:'',icon:null},{label:'Download',type:'action',action:'pdf',class:'',icon:null},{label:'Share',type:'menu',class:'',icon:null,action:'partials/paper_share_menu.html'},{label:'Send to Arxiv',type:'action',class:'',icon:null,action:'arxiv'},{label:'Switch ACE/Textarea',type:'action',class:'',icon:null,action:'switch_editor_mode'},{label:'Settings',type:'menu',class:'',icon:null,action:'partials/paper_settings.html'}]};e.menus=[];e.options=[];e.action=function(a){if(a.type=='action'){e.$emit('handleTopAction',a.action)}else if(a.type=='menu'){a.display=!a.display}return false}}]);