'use strict';angular.module('bluelatex.Shared.Controllers.Main',['bluelatex.User.Services.User','bluelatex.User.Services.Session','ngStorage','bluelatex.Paper.Services.Ace']).controller('MainController',['$rootScope','$scope','UserService','SessionService','$route','$location','$routeParams','AceService','$sessionStorage','$log','WindowActiveService',function(c,d,e,f,g,h,i,j,k,l,m){d.$route=g;d.$location=h;d.$routeParams=i;d.ace=j;d.$on('handleTopAction',function(a,b){d.$broadcast('handleAction',b)});d.$on("$routeChangeSuccess",function(a,b){d.currentRoute=b});var n=function(){if(k.username&&k.password){f.login(k.username,k.password).then(function(){e.getInfo({username:k.username}).then(function(a){c.loggedUser={name:k.username,first_name:a.first_name,last_name:a.last_name,email:a.email,etag:a.header.etag}},function(a){c.loggedUser={}})})}};var o=60*1000;var p=setInterval(n,o);n();m.registerObserverCallback(function(){var a=m.isActiveWindow();if(a==false){clearInterval(p);p=null}else if(p==null){p=setInterval(n,o);n()}})}]);