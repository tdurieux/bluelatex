angular.module('bluelatex.Paper.Controllers.EditPaper',['bluelatex.Paper.Services.Paper','bluelatex.User.Services.User','angucomplete']).controller('EditPaperController',['$scope','localize','$location','PaperService','UserService','$routeParams','$log','MessagesService',function(b,c,d,e,f,g,h,i){var j=g.id;var k={};e.getInfo(j).then(function(a){b.paper=a;b.paper.etag=a.header.etag;b.paper.id=j;k=clone(b.paper)},function(a){i.clear();switch(a.status){case 400:i.error('_Edit_paper_Some_parameters_are_missing_',a);break;case 401:i.error('_Edit_paper_Wrong_username_and_or_password_',a);break;case 404:i.error('_Edit_paper_Paper_not_found_',a);break;case 500:i.error('_Edit_paper_Something_wrong_happened_',a);break;default:i.error('_Edit_paper_Something_wrong_happened_',a)}});f.getUsers().then(function(a){console.log(a);b.users=a},function(a){i.clear();switch(a.status){case 400:i.error('_Edit_paper_Some_parameters_are_missing_',a);break;case 401:i.error('_Edit_paper_Wrong_username_and_or_password_',a);break;case 404:i.error('_Edit_paper_Paper_not_found_',a);break;case 500:i.error('_Edit_paper_Something_wrong_happened_',a);break;default:i.error('_Edit_paper_Something_wrong_happened_',a)}});b.users=[];b.new_author='';b.new_reviewer='';b.new_tag='';b.removeAuthor=function(a){b.paper.authors.splice(b.paper.authors.indexOf(a),1)};b.removeReviewer=function(a){b.paper.reviewers.splice(b.paper.reviewers.indexOf(a),1)};b.removeTag=function(a){b.paper.tags.splice(b.paper.tags.indexOf(a),1)};b.addAuthor=function(){var a=b.new_author;if(!a.title)return;if(b.paper.authors.indexOf(a.title)<0)b.paper.authors.push(a.title);b.new_author=''};b.addReviewer=function(){var a=b.new_reviewer;if(!a.title)return;if(b.paper.reviewers.indexOf(a.title)<0)b.paper.reviewers.push(a.title);b.new_reviewer=''};b.addTag=function(){var a=b.new_tag;if(b.paper.tags.indexOf(a)<0)b.paper.tags.push(a);b.new_tag=''};b.modify=function(){e.modify(b.paper,k).then(function(a){d.path("/papers")},function(a){i.clear();switch(a.status){case 400:i.error('_Edit_paper_Some_parameters_are_missing_',a);break;case 401:i.error('_Edit_paper_Wrong_username_and_or_password_',a);break;case 404:i.error('_Edit_paper_Paper_not_found_',a);break;case 500:i.error('_Edit_paper_Something_wrong_happened_',a);break;default:i.error('_Edit_paper_Something_wrong_happened_',a)}})}}]);